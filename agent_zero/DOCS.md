# Agent Zero - Home Assistant Addon

## Overview

Agent Zero is an open-source AI agent framework designed as a personal, organic, and dynamically growing assistant. It operates on a prompt-based architecture where the entire behavior is guided by system prompts.

### Key Features

- Multi-agent hierarchy
- Persistent memory
- Full transparency and customizability
- Skills system (SKILL.md standard)
- MCP Support
- A2A Protocol

## Installation

**⚠️ System Requirements:**
- Minimum 2GB RAM available for the addon
- Recommended 4GB+ RAM for optimal performance
- If running on low-memory systems (< 4GB total), you may need to increase swap space

### Steps

1. Add this repository to Home Assistant: `https://github.com/Invernomut0/agent-zero-hassio`
2. Go to Settings > Add-ons > Add-on Store
3. Find "Agent Zero" and click Install
4. Configure the addon (see Configuration section below)
5. Start the addon
6. **Add to sidebar** (see Sidebar Integration section)

**Note:** Initial startup may take 1-2 minutes as Agent Zero initializes.

## Development Tools Included

This addon extends the official Agent Zero image with additional development tools:
- **Node.js** - JavaScript runtime (included in base image)
- **npx** - Node package runner (included in base image)
- **Bun** - Fast JavaScript runtime and package manager (added)

These tools are available in the addon container for development and debugging purposes.

## Configuration

**⚠️ IMPORTANT:** This addon has no configuration options. All settings (LLM provider, API keys, models, etc.) are configured directly in the Agent Zero web interface after starting the addon.

The addon will automatically persist all your data including:
- Agent memory and conversation history
- Custom skills and knowledge base
- User profiles and configurations
- API keys and LLM settings

All data is stored in Home Assistant's `/data` directory and mapped to Agent Zero's `/a0/usr` directory for full persistence across restarts and updates.

## Sidebar Integration

**Important:** Due to Agent Zero's URL structure, it cannot use Home Assistant's built-in Ingress system. Instead, add it to your sidebar using `panel_iframe`.

### Method 1: Via UI (Recommended)

1. Go to **Settings** > **Dashboards** > **Add Dashboard**
2. Or edit existing dashboard settings
3. Add a new panel with:
   - **Title:** Agent Zero
   - **Icon:** mdi:robot
   - **URL:** `http://YOUR_HA_IP:50001`

### Method 2: Via configuration.yaml

Add this to your Home Assistant `configuration.yaml`:

```yaml
panel_iframe:
  agent_zero:
    title: "Agent Zero"
    icon: mdi:robot
    url: "http://YOUR_HA_IP:50001"
    require_admin: true
```

Replace `YOUR_HA_IP` with your Home Assistant IP address (e.g., `192.168.1.100`).

Then restart Home Assistant or reload the configuration.

### Accessing Agent Zero

- **Via Sidebar:** Click "Agent Zero" in your Home Assistant sidebar
- **Direct Access:** Navigate to `http://YOUR_HA_IP:50001`
- **Port:** Default is 50001 (matches Agent Zero's default)

## Security

**⚠️ WARNING:** This addon has significant capabilities including:
- Code execution
- Terminal/shell access
- File system access
- External API calls

**Recommendations:**
- Use strong passwords
- Only expose to trusted networks
- Enable `require_admin: true` in panel_iframe config
- Keep API keys secure in addon configuration
- Monitor addon logs regularly

## Troubleshooting

### Addon keeps restarting / OOM errors

If you see `exit status 137` or processes being killed in logs:

1. **Check available memory:** The addon requires ~1-2GB RAM during operation
2. **Increase system memory:** If your HA system has < 4GB total RAM, consider:
   - Increasing VM/system RAM allocation
   - Adding swap space (see [HA swap guide](https://community.home-assistant.io/t/how-to-increase-the-swap-file-size-on-home-assistant-os/272226))
   - Stopping other heavy addons temporarily
3. **Wait for initialization:** First startup can take 2-3 minutes - be patient

### "Cannot connect" or blank page

1. **Check addon is running:** Go to Settings > Add-ons > Agent Zero
2. **Verify logs:** Look for "Agent Zero is running" and "Uvicorn running on http://0.0.0.0:80"
3. **Check URL:** Ensure you're using `http://YOUR_HA_IP:50001`
4. **Port conflicts:** Make sure no other service is using port 50001
5. **Browser cache:** Clear browser cache or try incognito mode

### Authentication issues

1. Verify username/password in addon configuration match what you're entering
2. Check addon logs for authentication errors
3. Try restarting the addon after changing credentials

### API key errors

1. Ensure your LLM provider API key is correctly set in addon configuration
2. Verify the key has sufficient credits/permissions
3. Check provider-specific requirements (e.g., Anthropic needs `sk-ant-` prefix)

### Other Issues

- **Container won't start:** Check Home Assistant system logs
- **Black screen:** Wait 2-3 minutes for full initialization, then refresh
- **Performance issues:** Increase context_length or switch to a lighter model

## Data Persistence

**✅ Automatic Persistence:** All Agent Zero data is automatically persisted in Home Assistant's addon data directory.

The addon maps Home Assistant's `/data` to Agent Zero's `/a0/usr` directory, which contains:
- **Memory:** Agent memory and conversation history
- **Skills:** Custom uploaded skills (SKILL.md modules)
- **Knowledge:** Knowledge base documents
- **Profiles:** Agent profiles and configurations
- **Settings:** API keys, LLM provider settings, and preferences

**This data persists across:**
- Addon restarts
- Addon updates
- Home Assistant restarts
- Container rebuilds

**Note:** The first time you start the addon, you'll need to configure your LLM provider and API keys in the Agent Zero web interface. These settings will be saved and persist automatically.

## Support

- **GitHub Issues:** https://github.com/Invernomut0/agent-zero-hassio/issues
- **Agent Zero Documentation:** https://github.com/agent0ai/agent-zero
- **Home Assistant Community:** https://community.home-assistant.io

## License

MIT License
